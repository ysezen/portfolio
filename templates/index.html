{% extends './includes/layout.html' %}
{% load static %}

{% block container %}
    <div id="container" class="container">
        <!-- Left Menu / Logo-->

        <div class="content-scroller">
            <div class="content-wrapper">
                <!-- Introduction -->
                <article class="content introduction noscroll" id="chapterintroduction">
                    <div class="inner">
                        <h2><span>HEllo, I'm</span><br>{{ customer.firstname }}</h2>
                        <span class="title">{{ customer.title }}</span></div>
                    <div id="owl-demo" class="owl-carousel">
                        <div class="item"><img src="{% static 'img/profile.jpg' %}" alt=""/></div>
                        <div class="item"><img src="{% static 'img/profile-01.jpg' %}" alt=""/></div>
                        {#                        <div class="item"><img src="{% static 'img/profile-02.jpg' %}" alt=""/></div>#}
                    </div>
                </article>
                <!-- About -->
                <article class="content about white-bg" id="chapterabout">
                    <div class="inner">
                        <h2>About</h2>
                        <div class="title-divider"></div>
                        <div class="about-con">
                            <ul>
                                <li>
                                    Name: {{ customer.firstname }} {{ customer.middlename }} {{ customer.lastname }}</li>
                                {#                                <li>Email: <a href="mailto:{{ customer.email }}">{{ customer.email }}</a></li>#}
                                {#                                <li>Phone: <a href="tel:{{ customer.phone }}">{{ customer.phone_prettify }}</a></li>#}
                                {#                                <li>Date of birth: {{ customer.birthdate|date:"d.m.Y" }}</li>#}
                                <li>Address: <a
                                        href="https://www.google.com/maps/search/{{ customer.address_navigate }}"
                                        target="_blank">{{ customer.address_navigate }}</a></li>
                                {#                                <li>Nationality: {{ customer.nationality }}</li>#}
                            </ul>
                            <h3>Professional Profile</h3>
                            <p>{{ introduction.about|linebreaksbr }}<br>
                            </p>
                            {% if resume %}
                                <a href="{{ resume.file.url }}" target="_blank" class="button">Download resume as PDF
                                    format</a>
                            {% else %}
                                <p>No resume available.</p>
                            {% endif %}
                            <img src="{% static 'img/signature_new.png' %}" class="signature" alt=""/>
                            <img src="{% static 'img/qrcode.png' %}" class="signature" alt=""/>
                        </div>
                    </div>
                </article>

                <!-- Skills -->
                <article class="content skills gray-bg" id="chapterskills">
                    <div class="inner">
                        <h2>Skills</h2>
                        <div class="title-divider"></div>
                        <h3>Just My Awesome Skills</h3>
                        <p>{{ introduction.skill|linebreaksbr }}</p>
                        <div class="skills-con">
                            <div class="container-sub margin-top50">
                                <div class="row">
                                    {% for skill in skills %}
                                        {% if forloop.counter|divisibleby:4 == 1 or forloop.counter|divisibleby:4 == 2 %}
                                            <div class="col-6 margin-bottom20">
                                                <div class="col-6">
                                                    <span class="chart" data-percent="{{ skill.percentage }}"><span
                                                            class="percent"></span></span>
                                                </div>
                                                <div class="col-6 chart-text">
                                                    <h4>{{ skill.name }}</h4>
                                                    <p>{{ skill.description }}</p>
                                                </div>
                                            </div>
                                        {% else %}
                                            <div class="col-6 margin-bottom20">
                                                <div class="col-6">
                                                    <span class="chart" data-percent="{{ skill.percentage }}"><span
                                                            class="percent"></span></span>
                                                </div>
                                                <div class="col-6 chart-text">
                                                    <h4>{{ skill.name }}</h4>
                                                    <p>{{ skill.description }}</p>
                                                </div>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="full-divider"></div>
                            <div class="container-sub skill-list">
                                <div class="row">
                                    <h3>Knowledge</h3>
                                    <p>{{ introduction.knowledge }}</p>
                                    <div class="row">
                                        <div class="col-3 margin-top10">
                                            <h3>Frontend</h3>
                                            {% for knowledge in knowledges %}
                                                {% if knowledge.type == "Frontend" %}
                                                    <ul>
                                                        <li>{{ knowledge.name }}</li>
                                                    </ul>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <div class="col-3 margin-top10">
                                            <h3>Backend</h3>
                                            {% for knowledge in knowledges %}
                                                {% if knowledge.type == "Backend" %}
                                                    <ul>
                                                        <li>{{ knowledge.name }}</li>
                                                    </ul>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <div class="col-3 margin-top10">
                                            <h3>DataBase</h3>
                                            {% for knowledge in knowledges %}
                                                {% if knowledge.type == "DataBase" %}
                                                    <ul>
                                                        <li>{{ knowledge.name }}</li>
                                                    </ul>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <div class="col-3 margin-top10">
                                            <h3>DevOps</h3>
                                            {% for knowledge in knowledges %}
                                                {% if knowledge.type == "DevOps" %}
                                                    <ul>
                                                        <li>{{ knowledge.name }}</li>
                                                    </ul>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-3 margin-top10">
                                            <h3>Reporting</h3>
                                            {% for knowledge in knowledges %}
                                                {% if knowledge.type == "Reporting" %}
                                                    <ul>
                                                        <li>{{ knowledge.name }}</li>
                                                    </ul>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <div class="col-3 margin-top10">
                                            <h3>VCS</h3>
                                            {% for knowledge in knowledges %}
                                                {% if knowledge.type == "VCS" %}
                                                    <ul>
                                                        <li>{{ knowledge.name }}</li>
                                                    </ul>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <div class="col-3 margin-top10">
                                            <h3>IDE</h3>
                                            {% for knowledge in knowledges %}
                                                {% if knowledge.type == "IDE" %}
                                                    <ul>
                                                        <li>{{ knowledge.name }}</li>
                                                    </ul>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="full-divider"></div>
                            <div class="container-sub">
                                <div class="row">
                                    <h3>Language Skills</h3>
                                    <p>{{ introduction.language }}</p>
                                    {% for language in languages %}
                                        <div class="progressbar-main margin-top40">
                                            <div class="progress-bar-description">{{ language.name }} {{ language.description }}</div>
                                            <div id="progressBar3" class="progress">
                                                <div class="progress-value" style="width: {{ language.percentage }}%">
                                                    <span>{{ language.percentage }}</span>
                                                </div>
                                            </div>
                                        </div>
                                    {% endfor %}

                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <!-- Experience -->
                <article class="content experience white-bg" id="chapterexperience">
                    <div class="inner">
                        <h2>Experience</h2>
                        <div class="title-divider"></div>
                        <h3>20 Years Experience!</h3>
                        <p>{{ introduction.experience|linebreaksbr }}</p>
                        <div class="experience-con">
                            <div class="container-sub">
                                <div class="full-divider"></div>
                                <div class="row">
                                    {% for experience in experiences %}
                                        <div class="experience-details">
                                            <div class="col-6 margin-bottom50 margin-top50">
                                                <div class="col-3 icon-block">
                                                    <i class="fa fa-{{ experience.icon }}"></i></div>
                                                <div class="flot-left">
                                                    <h5>{{ experience.company_name }}</h5>
                                                    <h4>{{ experience.job_title }}</h4>
                                                    <span>
                                                            {% if experience.end_date %}
                                                                {{ experience.end_date|date:'Y' }}
                                                            {% else %}
                                                                present
                                                            {% endif %}
                                                        - {{ experience.start_date|date:'Y' }}
                                                    </span></div>
                                            </div>
                                            <div class="col-6 margin-bottom50 margin-top50 no-margin-top">{{ experience.description }}</div>
                                        </div>
                                        <div class="full-divider"></div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <!-- Certification -->
                <article class="content certification gray-bg" id="chaptercertification">
                    <div class="inner">
                        <h2>Certification</h2>
                        <div class="title-divider"></div>
                        <h3>A Journey Full of Success and Development</h3>
                        <p>{{ introduction.certification|linebreaksbr }}</p>
                        <div class="certification-con">
                            <div class="container-sub">
                                <div class="full-divider"></div>
                                <div class="row">
                                    {% for certification in certifications %}
                                        <div class="certification-details">
                                            <div class="col-6 margin-bottom50 margin-top50">
                                                <div class="icon-block">
                                                    <i class="fa fa-{{ certification.icon }}"></i>
                                                </div>
                                                <div class="flot-left">
                                                    <h5>{{ certification.organization }}</h5>
                                                    <h4>{{ certification.name }}</h4>
                                                    <span>{{ certification.date|date:"Y" }}</span>
                                                </div>
                                            </div>
                                            <div class="col-6 margin-bottom50 margin-top50 no-margin-top">{{ certification.description }}</div>
                                        </div>
                                        <div class="full-divider"></div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <!-- Education -->
                <article class="content education white-bg" id="chaptereducation">
                    <div class="inner">
                        <h2>Education</h2>
                        <div class="title-divider"></div>
                        <h3>Just My Education</h3>
                        <p>{{ introduction.education|linebreaksbr }}</p>
                        <div class="education-con">
                            <div class="container-sub">
                                <div class="full-divider"></div>
                                <div class="row">
                                    {% for education in educations %}
                                        <div class="education-details">
                                            <div class="col-6 margin-bottom50 margin-top50">
                                                <div class="col-3 icon-block"><i class="fa fa-{{ education.icon }}"></i>
                                                </div>
                                                <div class="flot-left">
                                                    <h5>{{ education.school_name }}</h5>
                                                    <h4>{{ education.major }}</h4>
                                                    <span>
                                                        {% if education.end_date %}
                                                            {{ education.end_date|date:'Y' }}
                                                        {% else %}
                                                            present
                                                        {% endif %} - {{ education.start_date|date:'Y' }}
                                                    </span></div>
                                            </div>
                                            <div class="col-6 margin-bottom50 margin-top50 no-margin-top">{{ education.description|linebreaksbr }}</div>
                                        </div>
                                        <div class="full-divider"></div>

                                    {% endfor %}

                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <!-- Contact -->
                <article class="content contact gray-bg" id="chaptercontact">
                    <div class="inner">
                        <h2>Contact</h2>
                        <div class="title-divider"></div>
                        <h3>Let's Keep In Touch</h3>
                        <p>{{ introduction.contact|linebreaksbr }}</p>
                        <div class="full-divider"></div>
                        <div class="contact-con margin-top50">
                            <div class="container-sub">
                                <div class="row">
                                    <div class="contact-details">
                                        <div class="col-6">
                                            <div class="contact-text">
                                                <div class="col-2 icon-block address"><i class="fa fa-map-marker"></i>
                                                </div>
                                                <div class="flot-left">
                                                    <strong>{{ customer.firstname }} {{ customer.middlename }} {{ customer.lastname }}</strong><br>
                                                    <a
                                                            href="https://www.google.com/maps/search/{{ customer.address_navigate }}"
                                                            target="_blank">{{ customer.address_navigate }}</a>
                                                </div>
                                            </div>
                                            {#                                            <div class="contact-text">#}
                                            {#                                                <div class="col-2 icon-block phone"><i class="fa fa-phone"></i></div>#}
                                            {#                                                <div class="flot-left"><strong>Phone</strong><br>#}
                                            {#                                                    <a href="tel:{{ customer.phone }}">{{ customer.phone_prettify }}</a>#}
                                            {#                                                </div>#}
                                            {#                                            </div>#}
                                            <div class="contact-text">
                                                <div class="col-2 icon-block email"><i class="fa fa-envelope"></i></div>
                                                <div class="flot-left"><strong>Email</strong><br>
                                                    <a href="mailto:{{ customer.email }}">{{ customer.email }}</a></div>
                                            </div>
                                        </div>
                                        <div class="col-6 m-margin-top30">
                                            <h3>I'm also on Social Networks</h3>
                                            <div class="contact-social margin-top30">
                                                {% for social_media in social_medias %}
                                                    <a href="{{ social_media.link }}" target="_blank">
                                                        <i class="fa fa-{{ social_media.icon }}"></i>
                                                    </a>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="full-divider"></div>
                            <div class="container-sub">
                                <div class="row">
                                    <div class="contact-form">
                                        <h3>Drop Me a Line</h3>
                                        <form id="form1" name="form1"
                                              method="post">
                                            {% csrf_token %}
                                            <input name="name" type="text" id="name" placeholder="Your Name..."/>
                                            <input name="email" type="text" id="email" placeholder="Your Email..."/>
                                            <textarea name="message" id="message" cols="45" rows="5"
                                                      placeholder="Your Message..."></textarea>
                                            <input type="submit" name="button" id="button" value="say hello!">
                                            <div id="successmsg"></div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <!-- Introduction -->
                <article class="content introduction-end" id="chapterthankyou">
                    <div class="inner">
                        <div class="introduction-end-con margin-top50">
                            <h3>
                                <strong>{{ customer.firstname }} {{ customer.middlename }} {{ customer.lastname }}</strong>
                            </h3>
                            <div id="rotate" class="rotate">
                                <div><span>awesome.</span></div>
                                <div><span>invincible.</span></div>
                                <div><span>unbeatable.</span></div>
                                <div><span>indestructible.</span></div>
                            </div>
                        </div>
                    </div>
                </article>

            </div>
            <!-- content-wrapper -->
        </div>
        <!-- content-scroller -->
    </div>

    <div id="message-container">
    </div>
    <div class="loading-container">
        <div class="lds-facebook">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

{% endblock %}


{% block extra_script %}
    <script>
        const form = document.querySelector('#form1');
        form.addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent the default form submission
            form.querySelector('#button').disabled = true; // Disable the submit button

            var formData = new FormData(event.target);
            showSpinner(); // Show the spinner when starting the request

            fetch('{% url "submit_contact_form" %}', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',  // Indicate that this is an AJAX request
                    'X-CSRFToken': '{{ csrf_token }}'     // Include the CSRF token for security
                }
            })
                .then(response => {
                    if (response.ok) {
                        // If the response is successful, reload the messages
                        return response.json(); // Get the response as json
                    } else {
                        throw new Error('Something went wrong'); // Handle errors
                    }
                })
                .then(data => {
                    // Update the message container with the new messages
                    const messageContainer = document.getElementById('message-container');
                    messageContainer.innerHTML = ''; // Clear previous messages
                    messageContainer.innerHTML = `<div class="alert alert-success">${data.data}</div>`; // Success message
                    document.getElementById('message-container').addEventListener('click', fadeOutToast); // Add event listener to fade out the toast
                    setTimeout(fadeOutToast, 3000); // Call fadeOutToast after a delay (e.g., 3 seconds)
                    document.getElementById('form1').reset(); // Reset the form                    
                })
                .catch(() => {
                    const messageContainer = document.getElementById('message-container');
                    messageContainer.innerHTML = `<div class="alert alert-danger">An unexpected error occurred.</div>`; // Display generic error message
                    document.getElementById('message-container').addEventListener('click', fadeOutToast); // Add event listener to fade out the toast
                    setTimeout(fadeOutToast, 3000); // Call fadeOutToast after a delay (e.g., 3 seconds)

                });
        });        

        // Function to automatically fade out the toast
        function fadeOutToast() {
            let messageContainer = document.getElementById('message-container');
            const alerts = messageContainer.getElementsByClassName('alert');
            for (let alert of alerts) {
                alert.classList.add('fade-out'); // Add fade-out class
                setTimeout(() => {
                    alert.remove(); // Remove the alert after fading out
                }, 500); // Match this duration with the CSS transition duration
            }
            document.getElementById('form1').querySelector('#button').disabled = false; // Enable the submit button
            hideSpinner(); // Hide the spinner after the request is completed
        }

        // Call fadeOutToast after a delay (e.g., 3 seconds)
        setTimeout(fadeOutToast, 3000);

        // Function to show the loading spinner
        function showSpinner() {
            document.querySelector('.loading-container').style.display = 'block';
        }

        // Function to hide the loading spinner
        function hideSpinner() {
            document.querySelector('.loading-container').style.display = 'none';
            //değişiklik gerekiyor
        }
    </script>
{% endblock %}